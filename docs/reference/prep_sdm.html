<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Prepare for running an SDM — prep_sdm • envSDM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare for running an SDM — prep_sdm"><meta property="og:description" content="Prepare for running an SDM"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">envSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/acanthiza/envSDM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prepare for running an SDM</h1>
    <small class="dont-index">Source: <a href="https://github.com/acanthiza/envSDM/blob/HEAD/R/prep_sdm.R" class="external-link"><code>R/prep_sdm.R</code></a></small>
    <div class="hidden name"><code>prep_sdm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prepare for running an SDM</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prep_sdm</span><span class="op">(</span></span>
<span>  this_taxa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">out_dir</span>,</span>
<span>  <span class="va">presence</span>,</span>
<span>  pres_crs <span class="op">=</span> <span class="fl">4326</span>,</span>
<span>  pres_x <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>  pres_y <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>  pred_limit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  limit_buffer <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pred_clip <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">predictors</span>,</span>
<span>  is_env_pred <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cat_preds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num_bg <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  prop_abs <span class="op">=</span> <span class="st">"abs"</span>,</span>
<span>  use_ecdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  many_p_prop <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  folds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  spatial_folds <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  min_fold_n <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  min_dens <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  use_cuts <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  dens_res <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  max_samp_iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  low_boost <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_pngs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  remove_corr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  corr_thresh <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  do_gc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force_new <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>this_taxa</dt>
<dd><p>Character. Name of taxa. Used to name outputs. If `NULL`,
this will be `basename(dirname(out_dir))`.</p></dd>


<dt>out_dir</dt>
<dd><p>Character. Name of directory into which results will be saved.</p></dd>


<dt>presence</dt>
<dd><p>Dataframe of presences. Needs columns called `lat` (latitude)
and `long` (longitude) both in decimal degrees.</p></dd>


<dt>pres_crs</dt>
<dd><p>Anything that will return a legitimate crs when passed to the
crs attribute of st_transform or st_as_sf</p></dd>


<dt>pred_limit</dt>
<dd><p>Logical. area of interest limits (i.e. MCP around points).
Can be `TRUE` (use points to generate a minimum convex polygon to use as a
limit), `FALSE` (do not limit) or path to existing sf to use.</p></dd>


<dt>limit_buffer</dt>
<dd><p>Numeric. Apply this buffer to `pred_limit` (in metres).</p></dd>


<dt>pred_clip</dt>
<dd><p>sf. Optional sf to clip the pred_limit back to (e.g. to
prevent prediction into ocean)</p></dd>


<dt>predictors</dt>
<dd><p>Character. Vector of paths to predictor `.tif` files.</p></dd>


<dt>is_env_pred</dt>
<dd><p>Logical. Does the naming of the directory and files in
`predictors` follow the pattern required by `envRaster::parse_env_tif()`?</p></dd>


<dt>cat_preds</dt>
<dd><p>Character. Vector of predictor names that are character.</p></dd>


<dt>num_bg</dt>
<dd><p>Numeric. How many background points?</p></dd>


<dt>prop_abs</dt>
<dd><p>Character. Is `num_bg` a proportion (`prop`) of the number of
records in `presence` or an absolute (`abs`) number?</p></dd>


<dt>use_ecdf</dt>
<dd><p>Logical. If `TRUE` the density raster is converted via
`ras_ecdf &lt;- ecdf(values(target_density)), target_density &lt;- terra::app(target_density, fun = \(i) ras_ecdf(i))`.
Creates wider density bands.</p></dd>


<dt>many_p_prop</dt>
<dd><p>Numeric. Ensure the number of background points is at
least `many_p_prop * number of presences`. e.g. If there are more than 5000
presences and num_bg is set at `10000` and `many_p_prop` is `2`, then num_bg
will be increased to `many_p_prop * nrow(presences)`</p></dd>


<dt>folds</dt>
<dd><p>Numeric. How many folds to use in cross validation? Will be
adjusted downwards if number of presences do not support `folds * min_fold_n`</p></dd>


<dt>spatial_folds</dt>
<dd><p>Logical. Use spatial folds? Even if `TRUE`, can resort
to non-spatial cv if presences per fold do not meet `min_fold_n` or there are
not enough presences to support more than one fold.</p></dd>


<dt>min_fold_n</dt>
<dd><p>Numeric. Sets both minimum number of presences, and,
by default, the minimum number of presences required for a model.</p></dd>


<dt>min_dens</dt>
<dd><p>Numeric. Usually a little above 0. Sets the minimum density
for background points. If zero, large areas of no background points can cause
trouble with model predictions into these areas.</p></dd>


<dt>use_cuts</dt>
<dd><p>Numeric. Used to set number of thresholds in `samp_df`. See
`envSDM::density_sample()`.</p></dd>


<dt>dens_res</dt>
<dd><p>`NULL` or numeric. Resolution (in metres) of density raster.
Set to `NULL` to use the same resolution as the predictors.</p></dd>


<dt>max_samp_iter</dt>
<dd><p>Numeric. Passed to max_sample argument of
`envSDM::density_sample()`.</p></dd>


<dt>low_boost</dt>
<dd><p>Numeric. Divisor for the lowest density cf the 2nd lowest
density. If the lowest density falls below this value, extra background
points are added. Helps to stop predicting high probabilities into areas with
very few background points.</p></dd>


<dt>save_pngs</dt>
<dd><p>Logical. Save out a .png of the density raster and spatial
blocks</p></dd>


<dt>remove_corr</dt>
<dd><p>Logical. If TRUE, predictors with high correlation
_at presences_ are removed.</p></dd>


<dt>corr_thresh</dt>
<dd><p>Numeric. Definition of 'high' correlation for `remove_corr`</p></dd>


<dt>do_gc</dt>
<dd><p>Logical. Run `base::rm(list = ls)` and `base::gc()` at end of
function? Useful when running SDMs for many, many taxa, especially if done in
parallel.</p></dd>


<dt>force_new</dt>
<dd><p>Logical. If outputs already exist, should they be remade?</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>`invisible(NULL)`. `prep.rds` (a list) and log written to `out_dir`</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"envSDM"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">out_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"envSDM"</span><span class="op">)</span>, <span class="st">"examples"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"predicts"</span><span class="op">)</span>, <span class="st">"ex"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span>regexp <span class="op">=</span> <span class="st">"\\.csv$"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span>, value <span class="op">=</span> <span class="st">"path"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>taxa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\.csv"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                  , presence <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">path</span>, <span class="fu">rio</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/rio/man/import.html" class="external-link">import</a></span>, setclass <span class="op">=</span> <span class="st">"tibble"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                  , presence <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">presence</span></span></span>
<span class="r-in"><span>                                          , \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>                                            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">lat</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                                          , <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">lon</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                                          <span class="op">)</span></span></span>
<span class="r-in"><span>                                          <span class="op">)</span></span></span>
<span class="r-in"><span>                  , out_dir <span class="op">=</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">out_dir</span>, <span class="va">taxa</span><span class="op">)</span></span></span>
<span class="r-in"><span>                  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">env_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"ex/bio.tif"</span>, package <span class="op">=</span> <span class="st">"predicts"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pwalk</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">taxa</span></span></span>
<span class="r-in"><span>                    , <span class="va">data</span><span class="op">$</span><span class="va">out_dir</span></span></span>
<span class="r-in"><span>                    , <span class="va">data</span><span class="op">$</span><span class="va">presence</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>               , <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span><span class="op">)</span> <span class="fu">prep_sdm</span><span class="op">(</span>this_taxa <span class="op">=</span> <span class="va">a</span></span></span>
<span class="r-in"><span>                                            , out_dir <span class="op">=</span> <span class="va">b</span></span></span>
<span class="r-in"><span>                                            , presence <span class="op">=</span> <span class="va">c</span></span></span>
<span class="r-in"><span>                                            , pres_x <span class="op">=</span> <span class="st">"lon"</span></span></span>
<span class="r-in"><span>                                            , pres_y <span class="op">=</span> <span class="st">"lat"</span></span></span>
<span class="r-in"><span>                                            , predictors <span class="op">=</span> <span class="va">env_dat</span></span></span>
<span class="r-in"><span>                                            , is_env_pred <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>                                            , pred_limit <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>                                            , limit_buffer <span class="op">=</span> <span class="fl">10000</span></span></span>
<span class="r-in"><span>                                            , dens_res <span class="op">=</span> <span class="fl">1000</span> <span class="co"># ignored as decimal degrees preds</span></span></span>
<span class="r-in"><span>                                            , use_ecdf <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>                                            <span class="op">)</span></span></span>
<span class="r-in"><span>               <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">prep_ex</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html" class="external-link">import</a></span><span class="op">(</span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">out_dir</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"prep.rds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prep_ex</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "inputs"             "original"           "timer"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4] "presence"           "predict_boundary"   "samp_df"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "bg_points"          "spp_pa_env"         "blocks"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "spatial_folds_used" "correlated"        </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Predict boundary with presences on 'land'</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">env_dat</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">prep_ex</span><span class="op">$</span><span class="va">predict_boundary</span><span class="op">)</span></span></span>
<span class="r-in"><span>              , add <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>              , col <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span>              , alpha <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span>              <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">presences</span> <span class="op">&lt;-</span> <span class="va">prep_ex</span><span class="op">$</span><span class="va">presence</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 , crs <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">env_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">presences</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Spatial blocks</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">prep_ex</span><span class="op">$</span><span class="va">blocks</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pa bio1 bio5 bio6 bio7 bio8 bio9 bio12 bio16 bio17      x      y  cell block</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1   83  215  -83  298  121   83   151   118     0 -66.25 -21.75 22996     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1   50  155  -95  249   65   50   804   411    34 -70.75 -13.75 20011     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1   85  225  -92  316  126   85   298   204     3 -65.25 -22.25 23184     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1   83  194  -59  253  109   83   325   218     5 -66.75 -18.75 21879     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1  120  228  -12  240  140  120   567   366    10 -65.75 -18.75 21881     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1   84  217  -83  300  125   84   166   122     1 -65.75 -23.25 23555     2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">background</span> <span class="op">&lt;-</span> <span class="va">prep_ex</span><span class="op">$</span><span class="va">blocks</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pa</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 , crs <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">env_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">background</span></span></span>
<span class="r-in"><span>              , pch <span class="op">=</span> <span class="fl">4</span></span></span>
<span class="r-in"><span>              , cex <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span>              , col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>              , add <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>              <span class="op">)</span></span></span>
<span class="r-plt img"><img src="prep_sdm-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stuart Brown, Nigel Willoughby.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

